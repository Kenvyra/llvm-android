From de237c8287443da417c1d05f4ca125c205aef6d2 Mon Sep 17 00:00:00 2001
From: Jens Reidel <adrian@travitia.xyz>
Date: Sun, 16 Oct 2022 13:19:00 +0300
Subject: [PATCH] Check lib64 for libs too

---
 base_builders.py | 17 ++++++++++++++++-
 builders.py      |  8 +++++++-
 2 files changed, 23 insertions(+), 2 deletions(-)

diff --git a/base_builders.py b/base_builders.py
index fc620a3..392cfc6 100644
--- a/base_builders.py
+++ b/base_builders.py
@@ -59,6 +59,7 @@ class LibInfo:
             raise RuntimeError('Version shouldn\'t be needed for Windows')
         libname = self.name + ('.so' if target_os.is_linux else '.dylib')
         lib = self.install_dir / 'lib' / libname
+        lib = lib if lib.exists() else self.install_dir / 'lib64' / libname
 
         if not lib.exists():
             raise RuntimeError('Lookup of version before library is built')
@@ -109,7 +110,21 @@ class LibInfo:
     def link_libraries(self) -> List[Path]:
         """Path to the libraries used when linking."""
         suffix = self._lib_suffix
-        return list(self.install_dir / 'lib' / f'{name}{suffix}' for name in self._lib_names)
+
+        libs = []
+
+        for name in self._lib_names:
+            path = self.install_dir / 'lib' / f'{name}{suffix}'
+
+            if path.exists():
+                libs.append(path)
+
+            path = self.install_dir / 'lib64' / f'{name}{suffix}'
+
+            if path.exists():
+                libs.append(path)
+
+        return libs
 
     @property
     def install_libraries(self) -> List[Path]:
diff --git a/builders.py b/builders.py
index 33e63b7..561049f 100644
--- a/builders.py
+++ b/builders.py
@@ -831,7 +831,13 @@ class LibXml2Builder(base_builders.CMakeBuilder, base_builders.LibInfo):
         if self._config.target_os.is_windows:
             return []
         ext = 'so' if self._config.target_os.is_linux else 'dylib'
-        return [self.install_dir / 'lib' / f'libxml2.{ext}']
+
+        path = self.install_dir / 'lib' / f'libxml2.{ext}'
+        
+        if not path.exists():
+            path = self.install_dir / 'lib64' / f'libxml2.{ext}'
+
+        return [path]
 
     @property
     def install_tools(self) -> List[Path]:
-- 
2.38.1

